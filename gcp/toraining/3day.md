- メモです
## DDoS攻撃
- 頭文字のDは「分散型」ディストリビュート
### botnet
- 一般にサイバー犯罪者がトロイの木馬やその他の悪意あるプログラムを使用して乗っ取った多数のゾンビコンピュータで構成されるネットワークのことを指す
### 対策
- googleロードバランサーの活用: デフォルトで防御機能が搭載されており、検知した場合には制限する
- 攻撃正面の提言: マシンをプライベートで管理、未使用なポートをブロック（1回は小さいながらリクエストに対してCPUを使用してしまう)、攻撃で使用されるsrcIP帯から自動でブロック（CloudArmor）
#### ファイアウォールのegressに関して
- egressの通信に関しては、設計するとセキュリティレベルは高くなるがコスパが悪い
- 制限するにも目的以外のOSアップデートなどの通信も考慮した上で設計する必要がある
- もし使用するなら、政府や金融機関などレベルになる
### DDoS専門部隊
- 相談を行うことで対応してくれるサービスが2021/4月にリリースされた
- DDoSで受けたクレジットを返還する
- 条件
  - Managed　Protectionというサービスに加入していること？
- 感覚：月額30万でDDoS対策の専門部隊を用意できる（普通なら100万以上かかるレベル）


## APIゲートウェイ
### 作成するには
- Cloud EndpointsやApigee
  - 新しいapiゲートウェイを推奨するが、ドキュメントが少ない
  - apigeeはドキュメントがあるので活用しやすい、機能も豊富だが金額が高いサブスク10m/mon以上

## Cloud Armor
- ロードバランサーの後ろに配置されるサービス
- IPレベルのブロック
### Googleエッジネット
- レイヤ３、４の攻撃を防ぐ
  - シンフラット攻撃
### ルール
- インジェクション系を拒否する設定できる
- WAF ルールのチューニング
  - https://cloud.google.com/armor/docs/rule-tuning?hl=ja
  - stableのルールを全追加すると多くの機能が使えなくなる
    - チューニングが必要になり、わりと経験値や運用後の調整になってくる部分が多い
    - [ datastudio ]を活用してダッシュボードで可視化する
      - 実際、要件レベルが高ければ毎週見直しをする事例もあり
      - 初期設定しておけば、データは自動で更新されるので事前準備必要なし

## ランサムウェア
### データ関連の
- 定期的なバックアップの実施
  - ランサムウェアはデータ復旧することを妨げるためにバックアップを標的にすることもある
  - 耐久性のあるバックアップがあれば、それも対策の一つになる
- IAMのベストプラクティスの活用
  - （事例）これらに関する規定を決めるのに３ヶ月要したことも
- date loss prevention apiの使用
  - 機密データが誤って露出しないようにマスキング・ハッシュ化など行い、限定的な場所で使用する
  - 機密データを認識して自動でマスキングなどの処理を行う
  - bigqueryとの連携も可能
### トラブル
- データの誤用
- プライバシーの脅威

## Security Command Center
- 基本無料サービス(2020/10~)
- 脆弱性のスキャン
- 必要権限
  - 組織管理者
  - SecurityCenter管理

## Operations
- Ops エージェント
  - loggingとmonitoringが統合したエージェントが用意され、簡単に導入できる
  - インストール
    - https://cloud.google.com/stackdriver/docs/solutions/ops-agent/installation?hl=ja

## ログ
### アクセスログ
- 普通はデフォルトでオフだが、Bigqueryのみデフォルトでオン
### 監査ログ
- デフォルト
  - 保存期間400日
### logs routing sink
- 他のプロジェクトに転送して保存できる
- 権限が必要
  - シンク作成時にIdentityが自動で作成される
  - パーミションON
  - sharedataset で「テーブル作成/ログの書き込み」を許可するとよい



- インジェクション系を拒否する設定できるk王撃緩和さく
- インジェクション系を拒否する設定できる
